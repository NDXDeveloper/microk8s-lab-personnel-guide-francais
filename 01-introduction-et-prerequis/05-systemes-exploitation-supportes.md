üîù Retour au [Sommaire](/SOMMAIRE.md)

# 1.5 - Syst√®mes d'exploitation support√©s

## Introduction

MicroK8s est con√ßu pour fonctionner sur une large gamme de syst√®mes d'exploitation, avec une pr√©f√©rence marqu√©e pour Linux o√π il offre les meilleures performances et la meilleure int√©gration. Cette section d√©taille les OS support√©s, leurs particularit√©s, et vous guide dans le choix du meilleur syst√®me pour votre laboratoire Kubernetes personnel.

## Vue d'ensemble de la compatibilit√©

### Tableau de support par OS

| Syst√®me | Support | Installation | Performance | Recommandation |
|---------|---------|--------------|-------------|----------------|
| **Ubuntu** | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Native | Snap direct | Excellente | Id√©al |
| **Debian** | ‚≠ê‚≠ê‚≠ê‚≠ê Excellent | Snap √† installer | Excellente | Tr√®s bon |
| **CentOS/RHEL** | ‚≠ê‚≠ê‚≠ê‚≠ê Excellent | Snap √† configurer | Excellente | Tr√®s bon |
| **Fedora** | ‚≠ê‚≠ê‚≠ê‚≠ê Excellent | Snap natif | Excellente | Tr√®s bon |
| **openSUSE** | ‚≠ê‚≠ê‚≠ê Bon | Snap √† installer | Bonne | Correct |
| **Arch Linux** | ‚≠ê‚≠ê‚≠ê Bon | AUR disponible | Bonne | Pour experts |
| **Windows** | ‚≠ê‚≠ê‚≠ê Via WSL2 | WSL2 requis | Moyenne | D√©veloppement |
| **macOS** | ‚≠ê‚≠ê‚≠ê Via Multipass | VM requise | Moyenne | D√©veloppement |
| **Raspberry Pi OS** | ‚≠ê‚≠ê‚≠ê‚≠ê Bon | Snap √† installer | Bonne | IoT/Edge |

## Linux : La plateforme native

### Ubuntu : Le choix optimal

Ubuntu est le syst√®me de pr√©dilection pour MicroK8s, d√©velopp√© par la m√™me soci√©t√© (Canonical).

**Versions recommand√©es :**
- **Ubuntu 22.04 LTS** (Jammy Jellyfish) - Support jusqu'en 2027
- **Ubuntu 24.04 LTS** (Noble Numbat) - Support jusqu'en 2029
- **Ubuntu 23.10** - Pour les derni√®res fonctionnalit√©s

**Avantages Ubuntu :**
```
‚úÖ Snap pr√©install√© et configur√©
‚úÖ Support officiel Canonical
‚úÖ Documentation extensive
‚úÖ Communaut√© la plus large
‚úÖ Int√©gration parfaite
‚úÖ Mises √† jour automatiques fluides
```

**Installation type Ubuntu :**
```bash
# Snap d√©j√† pr√©sent, installation directe
sudo snap install microk8s --classic

# Ajout au groupe microk8s
sudo usermod -a -G microk8s $USER
sudo chown -f -R $USER ~/.kube

# Reconnexion pour appliquer les groupes
newgrp microk8s
```

### Debian : La base stable

Debian offre une excellente stabilit√© pour un lab permanent.

**Versions support√©es :**
- **Debian 12** (Bookworm) - Actuelle stable
- **Debian 11** (Bullseye) - Oldstable
- **Debian Testing** - Pour les aventuriers

**Configuration Debian :**
```bash
# Installation de snapd
sudo apt update
sudo apt install snapd
sudo snap install core

# Red√©marrage recommand√©
sudo systemctl restart snapd

# Installation MicroK8s
sudo snap install microk8s --classic
```

**Particularit√©s Debian :**
- Plus conservateur que Ubuntu
- Packages plus anciens mais tr√®s stables
- Parfait pour un lab "set and forget"
- Moins de mises √† jour fr√©quentes

### Red Hat Enterprise Linux (RHEL) et d√©riv√©s

**Syst√®mes concern√©s :**
- RHEL 8/9
- CentOS Stream 8/9
- Rocky Linux 8/9
- AlmaLinux 8/9
- Oracle Linux 8/9

**Installation sur RHEL/CentOS :**
```bash
# Installation d'EPEL (Extra Packages)
sudo dnf install epel-release
sudo dnf upgrade

# Installation de snapd
sudo dnf install snapd
sudo systemctl enable --now snapd.socket

# Cr√©ation du lien symbolique
sudo ln -s /var/lib/snapd/snap /snap

# Red√©marrage n√©cessaire
sudo reboot

# Apr√®s red√©marrage
sudo snap install microk8s --classic
```

**Consid√©rations entreprise :**
- SELinux peut n√©cessiter des ajustements
- Firewalld √† configurer
- Support commercial disponible avec RHEL
- Conformit√© aux standards entreprise

### Fedora : Le moderne

Fedora offre les derni√®res technologies Linux.

**Versions support√©es :**
- Fedora 38/39 (versions actuelles)
- Rawhide (d√©veloppement)

**Avantages Fedora :**
- Kernel tr√®s r√©cent
- Technologies cutting-edge
- Bonne int√©gration snapd
- Cycle de release rapide (6 mois)

**Installation Fedora :**
```bash
# Snapd g√©n√©ralement pr√©install√©
sudo dnf install snapd

# Installation MicroK8s
sudo snap install microk8s --classic
```

### openSUSE : L'alternative europ√©enne

**Versions support√©es :**
- openSUSE Leap 15.x (stable)
- openSUSE Tumbleweed (rolling)

**Installation openSUSE :**
```bash
# Ajout du repository snapd
sudo zypper addrepo --refresh https://download.opensuse.org/repositories/system:/snappy/openSUSE_Leap_15.5 snappy

# Installation snapd
sudo zypper --gpg-auto-import-keys refresh
sudo zypper dup --from snappy
sudo zypper install snapd

# Activation
sudo systemctl enable snapd
sudo systemctl start snapd

# Installation MicroK8s
sudo snap install microk8s --classic
```

### Arch Linux : Pour les experts

Arch offre un contr√¥le total mais demande plus d'expertise.

**Installation Arch :**
```bash
# Via AUR (Arch User Repository)
yay -S snapd
sudo systemctl enable --now snapd.socket

# Ou via git
git clone https://aur.archlinux.org/snapd.git
cd snapd
makepkg -si

# Installation MicroK8s
sudo snap install microk8s --classic
```

**Consid√©rations Arch :**
- Rolling release (mises √† jour continues)
- Documentation wiki excellente
- Communaut√© technique avanc√©e
- Potentiel d'instabilit√©

## Windows : Via WSL2

### Windows Subsystem for Linux 2

WSL2 permet d'ex√©cuter MicroK8s sur Windows avec des performances correctes.

**Pr√©requis Windows :**
- Windows 10 version 2004+ (Build 19041+)
- Windows 11 (toutes versions)
- WSL2 activ√©
- Virtualisation activ√©e dans le BIOS

### Configuration WSL2

**√âtape 1 : Activer WSL2**
```powershell
# PowerShell en tant qu'administrateur
wsl --install
wsl --set-default-version 2

# Red√©marrer Windows
```

**√âtape 2 : Installer Ubuntu dans WSL2**
```powershell
# Installer Ubuntu depuis Microsoft Store ou :
wsl --install -d Ubuntu-22.04

# V√©rifier la version
wsl -l -v
```

**√âtape 3 : Configuration dans WSL2**
```bash
# Dans le terminal Ubuntu WSL2
# Augmenter les limites de ressources
sudo nano /etc/wsl.conf

# Ajouter :
[wsl2]
memory=4GB
processors=2
swap=2GB
localhostForwarding=true

# Installer MicroK8s
sudo snap install microk8s --classic
```

### Limitations Windows/WSL2

**Contraintes techniques :**
```
‚ö†Ô∏è Performance I/O r√©duite (~70% du natif)
‚ö†Ô∏è Consommation RAM suppl√©mentaire pour WSL2
‚ö†Ô∏è Networking plus complexe
‚ö†Ô∏è Pas d'acc√®s direct aux GPU
‚ö†Ô∏è Int√©gration syst√®me limit√©e
```

**Solutions aux probl√®mes courants :**

| Probl√®me | Solution |
|----------|----------|
| Lenteur I/O | Stocker les donn√©es dans WSL2, pas sur Windows |
| RAM limit√©e | Configurer `.wslconfig` |
| R√©seau inaccessible | Configurer port forwarding |
| DNS broken | Modifier `/etc/resolv.conf` |

### Windows Docker Desktop Alternative

Pour certains cas, Docker Desktop peut √™tre plus simple :

**Avantages Docker Desktop :**
- Interface graphique
- Int√©gration Windows native
- Support Kubernetes int√©gr√©
- Plus simple pour d√©butants

**Inconv√©nients :**
- Pas MicroK8s (donc diff√©rent du lab Linux)
- Licence commerciale pour entreprises
- Plus lourd en ressources

## macOS : Via virtualisation

### Approches pour macOS

macOS ne supportant pas les conteneurs Linux natifs, la virtualisation est n√©cessaire.

### Option 1 : Multipass (Recommand√©)

Multipass est l'outil officiel de Canonical pour VMs l√©g√®res.

**Installation Multipass :**
```bash
# Via Homebrew
brew install --cask multipass

# Ou t√©l√©chargement direct depuis multipass.run
```

**Cr√©ation VM avec MicroK8s :**
```bash
# Lancer une VM Ubuntu avec MicroK8s
multipass launch --name microk8s-vm --memory 4G --disk 40G

# Se connecter √† la VM
multipass shell microk8s-vm

# Dans la VM, installer MicroK8s
sudo snap install microk8s --classic
```

**Configuration r√©seau Multipass :**
```bash
# Port forwarding pour acc√®s aux services
multipass exec microk8s-vm -- sudo iptables -t nat -A PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 80

# Ou utiliser l'IP de la VM
multipass info microk8s-vm
```

### Option 2 : UTM (Apple Silicon)

Pour Mac M1/M2/M3, UTM offre une virtualisation native ARM.

**Configuration UTM :**
1. T√©l√©charger UTM depuis Mac App Store
2. Cr√©er VM Ubuntu ARM64
3. Allouer 4GB RAM, 2 CPU, 40GB stockage
4. Installer Ubuntu Server ARM64
5. Installer MicroK8s normalement

### Option 3 : VirtualBox (Intel Mac)

Pour Mac Intel, VirtualBox reste une option.

**Limitations macOS :**
```
‚ö†Ô∏è Pas d'installation native
‚ö†Ô∏è Performance r√©duite (VM overhead)
‚ö†Ô∏è Consommation RAM double (macOS + VM)
‚ö†Ô∏è Complexit√© r√©seau accrue
‚ö†Ô∏è Int√©gration limit√©e avec l'OS h√¥te
```

### Comparaison des options macOS

| Crit√®re | Multipass | UTM | VirtualBox | Docker Desktop |
|---------|-----------|-----|------------|----------------|
| **Simplicit√©** | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| **Performance** | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê | ‚≠ê‚≠ê‚≠ê |
| **Apple Silicon** | ‚úÖ | ‚úÖ | ‚ùå | ‚úÖ |
| **Intel Mac** | ‚úÖ | ‚úÖ | ‚úÖ | ‚úÖ |
| **MicroK8s natif** | ‚úÖ | ‚úÖ | ‚úÖ | ‚ùå |
| **Ressources** | Moyennes | Moyennes | √âlev√©es | √âlev√©es |

## Syst√®mes ARM et Edge

### Raspberry Pi OS

**Versions support√©es :**
- Raspberry Pi OS 64-bit (recommand√©)
- Raspberry Pi OS 32-bit (limit√©)
- Ubuntu Server pour Raspberry Pi (optimal)

**Installation sur Raspberry Pi :**
```bash
# Mise √† jour du syst√®me
sudo apt update && sudo apt upgrade -y

# Installation snapd
sudo apt install snapd

# Red√©marrage
sudo reboot

# Installation MicroK8s
sudo snap install microk8s --classic

# Configuration sp√©cifique Pi
# Augmenter la m√©moire GPU minimale
echo "gpu_mem=16" | sudo tee -a /boot/config.txt

# Activer cgroups
sudo sed -i 's/$/ cgroup_enable=memory cgroup_memory=1/' /boot/cmdline.txt
```

### Ubuntu Core (IoT)

Ubuntu Core est optimis√© pour l'IoT avec s√©curit√© renforc√©e.

**Caract√©ristiques Ubuntu Core :**
- Syst√®me enti√®rement snap
- Mises √† jour transactionnelles
- S√©curit√© renforc√©e
- Empreinte minimale

**Installation Ubuntu Core :**
```bash
# MicroK8s pr√©install√© ou :
snap install microk8s
```

### Autres syst√®mes ARM

**Support√©s :**
- NVIDIA Jetson (Ubuntu)
- Orange Pi (Armbian)
- Rock Pi (Ubuntu/Debian)
- Pine64 (Multiple OS)

**Consid√©rations ARM :**
- V√©rifier architecture (ARMv7/ARMv8/ARM64)
- Images Docker ARM n√©cessaires
- Performance variable selon SoC
- Refroidissement important

## Conteneurs et environnements sp√©ciaux

### Docker Container

Il est possible (mais d√©conseill√©) d'ex√©cuter MicroK8s dans Docker.

```dockerfile
# Dockerfile exemple (exp√©rimental)
FROM ubuntu:22.04
RUN apt-get update && \
    apt-get install -y snapd systemd && \
    systemctl enable snapd
# N√©cessite --privileged pour fonctionner
```

**Pourquoi √©viter :**
- Kubernetes dans Docker dans Docker = complexit√©
- Probl√®mes de privil√®ges
- Networking compliqu√©
- Utilisez plut√¥t Kind si n√©cessaire

### LXD/LXC Containers

MicroK8s peut fonctionner dans LXD avec configuration.

```bash
# Cr√©ation container LXD privil√©gi√©
lxc launch ubuntu:22.04 microk8s-container -c security.privileged=true -c security.nesting=true

# Configuration
lxc config set microk8s-container raw.lxc "lxc.apparmor.profile=unconfined"
lxc config device add microk8s-container kmsg unix-char source=/dev/kmsg

# Installation dans le container
lxc exec microk8s-container -- snap install microk8s --classic
```

### Cloud VMs

MicroK8s fonctionne sur toutes les VMs cloud :

**AWS EC2 :**
```bash
# Ubuntu AMI recommand√©
# t3.medium minimum (2 vCPU, 4 GB)
# Security groups : ouvrir ports n√©cessaires
```

**Google Cloud :**
```bash
# Ubuntu image
# e2-standard-2 minimum
# Firewall rules configur√©es
```

**Azure :**
```bash
# Ubuntu 22.04 LTS
# Standard_B2s minimum
# Network Security Group configur√©
```

**DigitalOcean :**
```bash
# Ubuntu Droplet
# 2GB RAM minimum
# Firewall cloud configur√©
```

## Choix du syst√®me selon le cas d'usage

### Matrice de d√©cision

| Cas d'usage | OS recommand√© | Pourquoi |
|-------------|---------------|----------|
| **Apprentissage Linux** | Ubuntu 22.04 LTS | Support optimal, documentation |
| **Lab permanent** | Debian 12 | Stabilit√© maximale |
| **Entreprise** | RHEL/Rocky | Support commercial, conformit√© |
| **D√©veloppement Windows** | WSL2 Ubuntu | Int√©gration d√©veloppeur |
| **D√©veloppement Mac** | Multipass Ubuntu | Simplicit√©, l√©g√®ret√© |
| **IoT/Edge** | Ubuntu Core/Raspberry Pi OS | Optimis√© embarqu√© |
| **CI/CD** | Ubuntu/Debian container | Reproductibilit√© |
| **Exp√©rimentation** | Fedora/Arch | Derni√®res technologies |

### Recommandations par profil

**D√©butant complet :**
```
1. Ubuntu 22.04 LTS Desktop
2. Installation basique
3. Documentation officielle
4. Communaut√© active
```

**D√©veloppeur Windows :**
```
1. Windows 11 + WSL2
2. Ubuntu 22.04 dans WSL2
3. VS Code avec extension Remote-WSL
4. Docker Desktop comme alternative
```

**D√©veloppeur Mac :**
```
1. Multipass pour simplicit√©
2. UTM pour contr√¥le
3. Ressources g√©n√©reuses (RAM)
4. Attention au networking
```

**Admin syst√®me :**
```
1. RHEL/Rocky pour entreprise
2. Debian pour stabilit√©
3. Ubuntu pour flexibilit√©
4. Automation avec Ansible
```

**Maker/Hobbyiste :**
```
1. Raspberry Pi OS 64-bit
2. Ubuntu Server pour Pi
3. Cluster multi-Pi
4. Projets IoT
```

## Configuration post-installation par OS

### Optimisations Ubuntu/Debian

```bash
# D√©sactiver swap
sudo swapoff -a
sudo sed -i '/ swap / s/^/#/' /etc/fstab

# Modules kernel
sudo modprobe overlay
sudo modprobe br_netfilter

# Param√®tres sysctl
cat <<EOF | sudo tee /etc/sysctl.d/kubernetes.conf
net.bridge.bridge-nf-call-ip6tables = 1
net.bridge.bridge-nf-call-iptables = 1
net.ipv4.ip_forward = 1
EOF

sudo sysctl --system
```

### Optimisations RHEL/CentOS

```bash
# SELinux en mode permissive (ou configur√©)
sudo setenforce 0
sudo sed -i 's/^SELINUX=enforcing$/SELINUX=permissive/' /etc/selinux/config

# Firewall
sudo firewall-cmd --permanent --add-port=16443/tcp
sudo firewall-cmd --permanent --add-port=10250-10252/tcp
sudo firewall-cmd --reload
```

### Optimisations Windows/WSL2

```powershell
# .wslconfig dans %UserProfile%
[wsl2]
memory=8GB
processors=4
swap=2GB
localhostForwarding=true

# Red√©marrer WSL
wsl --shutdown
```

### Optimisations macOS/Multipass

```bash
# Augmenter les ressources de la VM
multipass stop microk8s-vm
multipass set local.microk8s-vm.cpus=4
multipass set local.microk8s-vm.memory=8G
multipass start microk8s-vm
```

## Tableau de compatibilit√© des fonctionnalit√©s

| Fonctionnalit√© | Linux natif | WSL2 | macOS VM | Docker | Raspberry Pi |
|----------------|-------------|------|----------|---------|--------------|
| **Installation directe** | ‚úÖ | ‚úÖ | ‚ùå | ‚ö†Ô∏è | ‚úÖ |
| **Performance native** | ‚úÖ | ‚ö†Ô∏è | ‚ùå | ‚ùå | ‚ö†Ô∏è |
| **Multi-node** | ‚úÖ | ‚ö†Ô∏è | ‚ö†Ô∏è | ‚ùå | ‚úÖ |
| **GPU support** | ‚úÖ | ‚ùå | ‚ùå | ‚ùå | ‚ö†Ô∏è |
| **LoadBalancer (MetalLB)** | ‚úÖ | ‚ö†Ô∏è | ‚ö†Ô∏è | ‚ùå | ‚úÖ |
| **Storage local** | ‚úÖ | ‚ö†Ô∏è | ‚ö†Ô∏è | ‚ö†Ô∏è | ‚úÖ |
| **Monitoring complet** | ‚úÖ | ‚úÖ | ‚úÖ | ‚ö†Ô∏è | ‚ö†Ô∏è |
| **Production ready** | ‚úÖ | ‚ùå | ‚ùå | ‚ùå | ‚ö†Ô∏è |

## D√©pannage par OS

### Probl√®mes fr√©quents Ubuntu/Debian

| Probl√®me | Solution |
|----------|----------|
| Snap not found | `sudo apt install snapd` |
| Permission denied | `sudo usermod -a -G microk8s $USER` |
| DNS ne fonctionne pas | V√©rifier `/etc/resolv.conf` |
| Ports bloqu√©s | V√©rifier `ufw status` |

### Probl√®mes fr√©quents RHEL/CentOS

| Probl√®me | Solution |
|----------|----------|
| SELinux bloque | `sudo setenforce 0` temporaire |
| Firewall bloque | Ouvrir ports dans firewalld |
| Snap pas trouv√© | Installer EPEL d'abord |
| Kernel trop ancien | Mettre √† jour le syst√®me |

### Probl√®mes fr√©quents Windows/WSL2

| Probl√®me | Solution |
|----------|----------|
| WSL2 non disponible | Activer virtualisation BIOS |
| M√©moire insuffisante | √âditer `.wslconfig` |
| R√©seau inaccessible | Configurer port forwarding |
| Performance lente | Donn√©es dans WSL2, pas Windows |

### Probl√®mes fr√©quents macOS

| Probl√®me | Solution |
|----------|----------|
| VM ne d√©marre pas | V√©rifier Multipass service |
| R√©seau inaccessible | Utiliser IP de la VM |
| Performance lente | Augmenter ressources VM |
| Apple Silicon issues | Utiliser images ARM64 |

## Migration entre OS

### Sauvegarde avant migration

```bash
# Export des configurations
microk8s kubectl get all --all-namespaces -o yaml > backup-resources.yaml

# Sauvegarde des donn√©es
sudo tar -czf microk8s-backup.tar.gz /var/snap/microk8s/common/

# Export des images (optionnel)
microk8s ctr images export images-backup.tar $(microk8s ctr images list -q)
```

### Restauration sur nouveau syst√®me

```bash
# Installation MicroK8s sur nouveau syst√®me
sudo snap install microk8s --classic

# Restauration des donn√©es
sudo tar -xzf microk8s-backup.tar.gz -C /

# Application des ressources
microk8s kubectl apply -f backup-resources.yaml

# Import des images (si sauvegard√©es)
microk8s ctr images import images-backup.tar
```

## Conclusion

### R√©sum√© des recommandations

**Pour la meilleure exp√©rience MicroK8s :**

1. **Optimal** : Ubuntu 22.04/24.04 LTS sur machine physique Linux
2. **Excellent** : Debian 12, RHEL 8/9, Rocky Linux
3. **Bon** : WSL2 sur Windows, Multipass sur macOS
4. **Acceptable** : Raspberry Pi OS, Fedora, Arch
5. **D√©conseill√©** : Conteneurs Docker, anciennes versions d'OS

### Points cl√©s √† retenir

- **Linux natif** offre toujours les meilleures performances
- **Ubuntu** reste le choix le plus simple et le mieux support√©
- **WSL2** est viable pour le d√©veloppement Windows
- **macOS** n√©cessite une VM, acceptez l'overhead
- **ARM** fonctionne bien mais attention aux images Docker

### Conseil final

Choisissez l'OS avec lequel vous √™tes le plus √† l'aise pour commencer. Vous pourrez toujours migrer plus tard quand vous aurez plus d'exp√©rience. L'important est de d√©marrer votre apprentissage Kubernetes, pas d'avoir la configuration parfaite d√®s le d√©but.

---

*La section suivante pr√©sentera l'architecture g√©n√©rale d'un lab MicroK8s et comment les diff√©rents composants s'articulent ensemble.*

‚è≠Ô∏è
